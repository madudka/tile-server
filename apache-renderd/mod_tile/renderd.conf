# mod_tile configuration for Apache

<Directory /var/lib/mod_tile>
    Options Indexes FollowSymLinks MultiViews
    AllowOverride None
    Require all granted

    ModTileTileDir /var/lib/mod_tile

    # Load tile sets from renderd configuration
    LoadTileConfigFile /etc/renderd.conf

    # Enable tile delivery statistics
    ModTileEnableStats On

    # Disable bulk mode (request dirty tiles for re-rendering)
    ModTileBulkMode Off

    # Rendering timeouts (seconds)
    ModTileRequestTimeout 3
    ModTileMissingRequestTimeout 10

    # Load thresholds for rendering decisions
    ModTileMaxLoadOld 2
    ModTileMaxLoadMissing 5

    # Renderd socket path
    ModTileRenderdSocketName /run/renderd/renderd.sock

    # Cache control - maximum cache duration (seconds)
    ModTileCacheDurationMax 604800

    # Cache duration for dirty tiles (seconds)
    ModTileCacheDurationDirty 900

    # Minimum cache duration for fresh tiles (seconds)
    ModTileCacheDurationMinimum 10800

    # Zoom-based cache durations
    ModTileCacheDurationMediumZoom 13 86400
    ModTileCacheDurationLowZoom 9 518400

    # Cache duration based on last modification time
    ModTileCacheLastModifiedFactor 0.20

    # Tile throttling (disabled by default)
    ModTileEnableTileThrottling Off
    ModTileEnableTileThrottlingXForward 0

    # Throttling parameters: pool_size rate_per_second
    ModTileThrottlingTiles 10000 1
    ModTileThrottlingRenders 128 0.2
</Directory>